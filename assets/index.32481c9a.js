(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function a(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerpolicy&&(c.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?c.credentials="include":l.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(l){if(l.ep)return;l.ep=!0;const c=a(l);fetch(l.href,c)}})();const N="/fed22d-js-grundkurs-2-wumpus-MattiasHeurlin/assets/acessgranted.a8080d6d.png",U="/fed22d-js-grundkurs-2-wumpus-MattiasHeurlin/assets/arrow.d12509f9.png",q="/fed22d-js-grundkurs-2-wumpus-MattiasHeurlin/assets/adventure.1edaa50a.png",P="/fed22d-js-grundkurs-2-wumpus-MattiasHeurlin/assets/endlesshole.b7b50d5d.jpg",G=document.querySelector("#mainStage"),i=document.querySelector("#mainTextArea"),u=document.querySelector("#userTextInput"),k=document.querySelector("#errorMsg"),m=document.querySelector("#gameOver"),y=document.querySelector("#roomCanvas");let d;const C=new Image;C.src=q;const E=new Image;E.src=U;const A=new Image;A.src=N;const R=new Image;R.src=P;const O=[{name:"Mattias",score:10}],f=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}];let b="";const n={x:0,y:0};let H,h=0,x=3,w=10,g=!1;const s=[[{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1}],[{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1}],[{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1}],[{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1}],[{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1},{containsWumpus:!1,containsItem:[],containsTrap:!1,containsBat:!1}]];function r(e){return Math.floor(Math.random()*e)}function V(){for(let e=0;e<5;e++){let t=0,a=r(5),o=r(4);for(;(a===0&&o===0||s[a][o].containsTrap||s[a][o].containsWumpus||s[a][o].containsItem.length>0||s[a][o].containsBat)&&t<20;)a=r(5),o=r(4),t+=1,t===19&&console.error("Unable to place all items.");e<2&&s[a][o].containsItem.push("bonusItem"),e<4&&s[a][o].containsItem.push("arrowItem"),e===4&&s[a][o].containsItem.push("coinItem"),console.log(`Items have been placed: ${e}: ${a}:${o}`)}}function X(){for(let e=0;e<4;e++){let t=0,a=r(5),o=r(4);for(;(a===0&&o===0||s[a][o].containsTrap||s[a][o].containsBat)&&t<20;)a=r(5),o=r(4),t+=1,t===19&&console.error("Unable to place traps.");s[a][o].containsTrap=!0,console.log(`Traps have been placed: ${a}:${o}`)}}function F(){for(let e=0;e<6;e++){let t=0,a=r(5),o=r(4);for(;(a===0&&o===0||s[a][o].containsTrap||s[a][o].containsBat)&&t<20;)a=r(5),o=r(4),t+=1,t===19&&console.error("Unable to place bats.");s[a][o].containsBat=!0,console.log(`Bats have been placed: ${a}:${o}`)}}function K(){let e=r(5),t=r(4);for(;e===0&&t===0;)e=r(5),t=r(4);s[e][t].containsWumpus=!0,H=`Wumpus location: ${e}, ${t}`,console.log(H)}function Y(){K(),X(),F(),V()}function I(e){return e<0&&(e=4),e>4&&(e=0),e}function T(e){return e<0&&(e=3),e>3&&(e=0),e}function z(){const e={bats:!1,traps:!1,wumpus:!1};for(let t=0;t<4;t++){let a=n.x+f[t].x,o=n.y+f[t].y;a=I(a),o=T(o),s[a][o].containsBat&&!e.bats&&(i.innerHTML+="<br> I hear the menacing sounds of bats nearby... <br>",e.bats=!0),s[a][o].containsTrap&&!e.traps&&(i.innerHTML+="<br> I feel a rush of wind, there must be a huge bottomless hole nearby... <br>",e.traps=!0),s[a][o].containsWumpus&&!e.wumpus&&(i.innerHTML+="<br> I smell the most awful of smells... <br>",e.wumpus=!0),a=0,o=0}!e.bats&&!e.traps&&!e.wumpus&&(i.innerHTML+="<br> I get a feeling that everything is fine... <br>")}function D(){B();for(let e=0;e<s.length;e++)for(let t=0;t<s[e].length;t++)s[e][t].containsBat=!1,s[e][t].containsTrap=!1,s[e][t].containsWumpus=!1,s[e][t].containsItem.length=0;Y(),x=3,h=0,n.x=0,n.y=0,b="",w=0,m.classList.add("hidden"),h=1,u.value="",g=!1,$()}function J(){const e={name:b,score:w};O.push(e)}function L(e,t){var a;e&&J(),i.innerHTML="",console.log("Gameover screen triggerd"),m.classList.remove("hidden"),u.classList.add("hidden"),e?m.innerHTML="VICTORY! <br> <br>":m.innerHTML="GAME OVER <br> <br>",m.innerHTML+=`
  ${b} ${t}
  <br> <br> Highscore list:
    <ul> `,O.forEach(o=>{m.innerHTML+=`<li> ${o.name}: ${o.score} </li>`}),m.innerHTML+=`</ul> 
  <button id="restartBtn">Restart Game?</button>`,(a=document.querySelector("#restartBtn"))==null||a.addEventListener("click",D)}function W(e,t){if(k.innerHTML="",u.classList.remove("hidden"),s[e][t].containsBat)i.innerHTML=`As you enter the cave you see a giant bat flying straight at you! <br> 
    <br> As you try to escape the bat catches you by the leg and flyes away with you. 
    <br> You manage to break free and fall down to a cave nearby.`,u.classList.add("hidden"),setTimeout(()=>{Q()},3e3);else if(s[e][t].containsTrap){if(i.innerHTML=`As you enter the cave you see a giant hole in the middle. <br> 
    <br> You easily go around the hole and as you are almost in the clear. <br>
    <br> You slip and fall into the hole.`,g){i.innerHTML+=`<br> <br> After falling for two minutes you feel your right pocket heat up. 
      As you put your hand in the pocket and feel the burning hot coin you blink and you 
      find your self back in the cave again. <br> <br>
      Where would you like to go next? N/S/W/E`;return}u.classList.add("hidden"),setTimeout(()=>{d.drawImage(R,0,0,300,200),L(!1,"fell into endless hole")},3e3);return}else if(s[e][t].containsWumpus){if(i.innerHTML=`As you enter the cave you you smell the foulest of smells. <br>
    <br> A movement deep in the dark is the last thing you see before you are slayed.`,g){for(i.innerHTML=`As you enter the cave you you smell the foulest of smells. <br>
      <br> A movement deep in the dark is the last thing you see before 
      the coin in your pocket bursts and you find your self in a new cave. <br> <br>`,n.x=r(5),n.y=r(4);s[n.x][n.y].containsTrap||s[n.x][n.y].containsWumpus||s[n.x][n.y].containsBat;)n.x=r(5),n.y=r(4);g=!1,W(n.x,n.y);return}u.classList.add("hidden"),setTimeout(()=>{L(!1,"was eaten by the Wumpus")},3e3);return}else i.innerHTML="You have entered a new cave. <br>",M("show"),z(),s[e][t].containsItem.length>0&&(s[e][t].containsItem.includes("bonusItem")&&(i.innerHTML+="<br> I find a chest with valuables inside... (Bonus Point)",w+=3),s[e][t].containsItem.includes("arrowItem")&&(i.innerHTML+="<br> I find a chest with valuables inside... (Bonus Point)",w+=3),s[e][t].containsItem.includes("coinItem")&&(i.innerHTML+=`<br> On a table in the corner of the cave 
          there is a single gold coin... (Strange Coin Added)`,g=!0),s[e][t].containsItem=[]);i.innerHTML+="<br> <br> Where would you like to go next? N/S/W/E"}function Q(){const e=r(2);for(console.log("Batmove is triggered"),e===0?n.x+=r(3):n.y-=r(3),n.x=I(n.x),n.y=T(n.y);s[n.x][n.y].containsBat||s[n.x][n.y].containsTrap||s[n.x][n.y].containsWumpus;)n.x+=r(4),n.y+=r(4),n.x=I(n.x),n.y=T(n.y),console.warn("Batmove while loop triggerd");W(n.x,n.y)}function $(){var e;i.innerHTML=`<span> Great! 
  What would you like your character to be called? <br> Press "Enter" to continue </span>`,u.classList.toggle("hidden"),(e=document.querySelector("#startBtn"))==null||e.classList.add("hidden"),B()}function v(e){let t=n.x,a=n.y;x-=1;const o=c=>new Promise(p=>setTimeout(p,c));async function l(){for(let c=0;c<3;c++){if(t+=f[e].x,a+=f[e].y,t=I(t),a=T(a),d.drawImage(E,t*60,a*50,35,35),s[t][a].containsWumpus){L(!0,"has slain the Wumpus"),c=3;return}if(t===n.x&&a===n.y){L(!1,"shot himself with an arrow");return}await o(600),d.clearRect(t*60,a*50,55,45)}}l(),i.innerHTML.includes("It appears the arrow did not hit anything")||(i.innerHTML+="<br> <br> It appears the arrow did not hit anything...")}function Z(e){switch(e.toLowerCase().replace("shoot ","")){case"n":case"north":v(0);break;case"s":case"south":v(1);break;case"w":case"west":v(2);break;case"e":case"east":v(3);break;default:console.log(e),k.innerHTML=' <br> <br> Wrong input. Use "Shoot N/S/W/E"';break}x===1&&i.innerHTML.includes("VICTORY!")&&(i.innerHTML+="<br> <br> You are down to your last arrow. If you waste it, there is no hope."),x===0&&i.innerHTML.includes("VICTORY!")&&L(!1,"ran out of arrows")}function _(e){let t=!1;switch(w-=1,e.toLowerCase()){case"n":case"north":console.log(e),n.x+=f[0].x,n.y+=f[0].y,console.log("N is triggerd");break;case"s":case"south":n.x+=f[1].x,n.y+=f[1].y,console.log("S is triggerd");break;case"w":case"west":n.x+=f[2].x,n.y+=f[2].y,console.log("W is triggerd");break;case"e":case"east":n.x+=f[3].x,n.y+=f[3].y,console.log("E is triggerd");break;default:k.innerHTML="<br> <br> Wrong input. Use N/S/W/E",console.log("default movement"),t=!0;break}t||(n.x=I(n.x),n.y=T(n.y),W(n.x,n.y))}function M(e){switch(e){case"clear":d.clearRect(n.x*60,n.y*50,55,45);break;case"show":d.drawImage(C,n.x*60,n.y*50,40,40);break;default:console.error("handleUserImg function param");break}}function B(){if(y.getContext){console.log(y),d=y.getContext("2d");for(let e=0;e<s.length;e++)for(let t=0;t<s[e].length;t++)d.fillStyle="rgb(9, 10, 41)",d.fillRect(e*60,t*50,60,50),d.clearRect(e*60,t*50,55,45)}else console.error("Canvas is not supported"),y.classList.add("hidden")}function j(e){if(e.key==="Enter"){if(h===0&&(b=u.value,i.innerHTML=`Lets get started ${b}! <br> <br> You are currently in the caves under the 
      castle of Greveholm. 
      Afraid to be alone? Lucky for you, you are not. There is also a beast by the name of Wumpus in the
      treturous cave system. Your goal is to find and slay the Wumpus. There is loot you can find along 
      the way to aid you, if you find it. Currently you only have a bow and three arrows.
      You navigate using the field below. 
      Simply put in the direktion you would like to go in. <br> <br> Either using full names or the first letter.
      <br> North / South / West / East <br> <br>
      If you wish to shoot your bow, insert "Shoot" and the direction. <br> <br>
      Press Enter again to enter the first cave;`),h===1&&(W(0,0),G.classList.add("turned-on"),y.classList.remove("hidden"),d.clearRect(0,0,300,200),d.drawImage(A,0,0,300,200),setTimeout(()=>{B(),M("show")},1500)),h>1){if(u.value.toLowerCase().includes("shoot")){Z(u.value),u.value="";return}M("clear"),console.log("enterCounter more than 1"),_(u.value)}h+=1,u.value=""}}u.addEventListener("keypress",j);var S;(S=document.querySelector("#startBtn"))==null||S.addEventListener("click",$);Y();console.table(s);
